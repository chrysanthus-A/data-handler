import{c as v,r as P,j as e,b as I,g as E}from"./App-7igUDzL4.js";import{g as N,H as T,T as _}from"./tree-WpljIsvM.js";const f=document.getElementById("popup2"),B=v.createRoot(f);let b="";async function u(l,a){let s=window.sessionStorage.getItem("token");a.headers={auth:s||null};let r=new Request(I+l,a),d=await fetch(r);d=await d.json();try{d.code!==200&&window.location.replace("/data-handler/login")}catch{}return d.data}function L(l){const[a,s]=P.useState("Workspaces");P.useEffect(()=>{b=a},[a]);const r=async t=>{document.getElementById("tabs").childNodes.forEach(h=>{h.classList.remove("btn-clicked")}),t.target.classList.add("btn-clicked"),await d(t.target.innerHTML,"listdiv")};async function d(t,n,h=null){let m={method:"GET"},y;switch(t){case"Workspaces":s("Workspaces"),y=await u("/workspaces/tree",m);break;case"Projects":s("Projects"),y=await u("/projects/tree",m);break;case"Pages":s("Pages"),y=await u("/pages/tree",m);break}k(y,n,t,h)}async function j(){let t=N();const n=()=>{f.classList.remove("open-popup2")};f.classList.add("open-popup2"),B.render(e.jsx(S,{close:n,type:t.type,name:t.name,data:t}))}function S(t){async function n(h,m,y){let w=document.getElementById("new-name").value,i,o,c,p;switch(h){case"Workspaces":i={method:"POST",body:JSON.stringify({WS_old:m,WS_new:w})},await u("/workspaces/rename",i);break;case"Projects":o=y.hierarchy.split("-//-"),c=o[0],i={method:"POST",body:JSON.stringify({Pold:m,Pnew:w,WSname:c})},await u("/projects/rename",i);break;case"Pages":o=y.hierarchy.split("-//-"),c=o[0],p=o[1],i={method:"POST",body:JSON.stringify({PGold:m,PGnew:w,WSname:c,Pname:p})},await u("/pages/rename",i);break}d(b,"listdiv",y.hierarchy_ID.split("-//-"))}return e.jsxs("div",{className:"container2",children:[e.jsx("div",{className:"exitButton",children:e.jsx("button",{type:"button",onClick:t.close,children:"X"})}),e.jsxs("div",{className:"ws-name-input",children:[e.jsxs("label",{htmlFor:"ws-name",children:["Selected Type: ",t.type]}),e.jsxs("label",{htmlFor:"ws-name",children:["Current Name: ",t.name]}),e.jsx("label",{htmlFor:"ws-name",children:"New Name:"}),e.jsx("input",{type:"text",className:"ws-name",id:"new-name",placeholder:"Type new name here"})]}),e.jsx("div",{className:"submit-button",children:e.jsx("button",{type:"button",onClick:()=>n(t.type,t.name,t.data),children:"Rename"})})]})}async function C(){let t=N(),n;switch(t.type){case"Workspaces":n={method:"POST",body:JSON.stringify({WSname:t.name})},await u("/workspaces/delete",n);break;case"Projects":n={method:"POST",body:JSON.stringify({WSname:t.ws,Pname:t.name})},await u("/projects/delete",n);break;case"Pages":n={method:"POST",body:JSON.stringify({WSname:t.ws,Pname:t.project,PGname:t.name})},await u("/pages/delete",n);break}d(a,"listdiv",t.hierarchy_ID.split("-//-").slice(0,-1))}function O(){const t=()=>{try{document.getElementById("error-log").innerHTML="",document.getElementById("ws-name").value="",document.getElementById("pj-name").value="",document.getElementById("pg-name").value=""}catch{}f.classList.remove("open-popup2")};f.classList.add("open-popup2"),B.render(e.jsx(W,{close:t}))}function W(t){async function n({ws:m=!1,pj:y=!1,pg:w=!1}){window.sessionStorage.getItem("token");let i;if(m){let o=document.getElementById("ws-name").value,c={method:"POST",body:JSON.stringify({name:o})};i=await u("/workspaces/tree",c)}else if(y){let o=document.getElementById("pj-name").value,c=document.getElementById("ws-name").value,p={method:"POST",body:JSON.stringify({Pname:o,w_name:c})};i=await u("/projects/tree",p)}else if(w){let o=document.getElementById("pj-name").value,c=document.getElementById("ws-name").value,p=document.getElementById("pg-name").value,g={method:"POST",body:JSON.stringify({Pname:o,WSname:c,PGname:p})};i=await u("/pages/tree",g)}i.code===405?document.getElementById("error-log").innerHTML=i.status:d(b,"listdiv")}async function h({ws:m=!1,pj:y=!1,ws_name:w=null,clear:i=!1}){try{(m||i)&&document.getElementById("ws-data").remove(),(y||i)&&document.getElementById("pj-data").remove()}catch{}const o={method:"GET"};if(m){let c=await u("/workspaces",o),p=document.createElement("datalist");p.id="ws-data",console.log(c),c.forEach(g=>{let x=document.createElement("option");x.setAttribute("value",g),p.appendChild(x)}),document.body.appendChild(p)}if(y){o.method="POST",o.body=JSON.stringify({wsName:w});let c=await u("/projects",o),p=document.createElement("datalist");p.id="pj-data",console.log(c),c.forEach(g=>{let x=document.createElement("option");x.setAttribute("value",g),p.appendChild(x)}),document.body.appendChild(p)}}if(b==="Workspaces")return h({clear:!0}),e.jsxs("div",{className:"container2",children:[e.jsx("div",{className:"exitButton",children:e.jsx("button",{type:"button",onClick:t.close,children:"X"})}),e.jsxs("div",{className:"ws-name-input",children:[e.jsxs("label",{htmlFor:"ws-name",children:[b," Name:"]}),e.jsx("input",{type:"text",className:"ws-name",id:"ws-name",placeholder:`Enter the name of the ${b} here`}),e.jsx("label",{id:"error-log"})]}),e.jsx("div",{className:"submit-button",children:e.jsx("button",{type:"button",onClick:()=>{h({clear:!0}),n({ws:!0})},children:"Create"})})]});if(b==="Projects")return h({ws:!0}),e.jsxs("div",{className:"container2",children:[e.jsx("div",{className:"exitButton",children:e.jsx("button",{type:"button",onClick:t.close,children:"X"})}),e.jsxs("div",{className:"ws-name-input",children:[e.jsx("label",{htmlFor:"ws-name",children:"Workspace Name:"}),e.jsx("input",{type:"text",className:"ws-name",id:"ws-name",placeholder:"Enter Workspace Name",list:"ws-data",autoComplete:"false"}),e.jsxs("label",{htmlFor:"ws-name",children:[b," Name:"]}),e.jsx("input",{type:"text",className:"ws-name",id:"pj-name",placeholder:`Enter the name of the ${b} here`}),e.jsx("label",{id:"error-log"})]}),e.jsx("div",{className:"submit-button",children:e.jsx("button",{type:"button",onClick:()=>{h({clear:!0}),n({pj:!0})},children:"Create"})})]});if(b==="Pages")return h({ws:!0}),e.jsxs("div",{className:"container2",children:[e.jsx("div",{className:"exitButton",children:e.jsx("button",{type:"button",onClick:t.close,children:"X"})}),e.jsxs("div",{className:"ws-name-input",children:[e.jsx("label",{htmlFor:"ws-name",children:"Workspace Name:"}),e.jsx("input",{type:"text",className:"ws-name",id:"ws-name",placeholder:"Select Workspace",list:"ws-data",autoComplete:"false",onChange:m=>h({pj:!0,ws_name:m.target.value})}),e.jsx("label",{htmlFor:"ws-name",children:"Project Name:"}),e.jsx("input",{type:"text",className:"ws-name",id:"pj-name",placeholder:"Select Project",list:"pj-data",autoComplete:"false"}),e.jsxs("label",{htmlFor:"ws-name",children:[b," Name:"]}),e.jsx("input",{type:"text",className:"ws-name",id:"pg-name",placeholder:`Enter the name of the ${b} here`}),e.jsx("label",{id:"error-log"})]}),e.jsx("div",{className:"submit-button",children:e.jsx("button",{type:"button",onClick:()=>{h({clear:!0}),n({pg:!0})},children:"Create"})})]})}return e.jsxs("div",{className:"container",children:[e.jsxs("div",{className:"exitButton",children:[e.jsx("label",{children:e.jsxs("h4",{children:["Manage ",a]})}),e.jsx("button",{type:"button",onClick:l.close,children:"X"})]}),e.jsxs("div",{className:"tabs",id:"tabs",children:[e.jsx("button",{className:"tabBtns",onClick:r,children:"Workspaces"}),e.jsx("button",{className:"tabBtns",onClick:r,children:"Projects"}),e.jsx("button",{className:"tabBtns",onClick:r,children:"Pages"})]}),e.jsxs("div",{className:"main",children:[e.jsx("div",{className:"lists",id:"listdiv"}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{type:"button",onClick:O,id:"addBtn",children:"Add"}),e.jsx("button",{type:"button",onClick:C,id:"removeBtn",children:"Remove"}),e.jsx("button",{type:"button",onClick:j,id:"renameBtn",children:"Rename"})]})]})]})}const J=v.createRoot(document.getElementById("headdiv")),R=v.createRoot(document.getElementById("popup")),D=v.createRoot(document.getElementById("buttonsdiv")),F=async l=>{let a={method:"GET"},s,r=l.target.value||"Workspaces";switch(r){case"Workspaces":s=await E("/workspaces/tree",a),k(s,"filediv",r);break;case"Projects":s=await E("/projects/tree",a),k(s,"filediv",r);break;case"Pages":s=await E("/pages/tree",a),k(s,"filediv",r);break}};J.render(e.jsx(T,{base:I,onchange:F}));const M=e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",id:"open_btn",onClick:G,children:"Open Model"}),e.jsx("button",{type:"button",onClick:H,children:"Manage Models"})]});D.render(M);async function G(){let l=N();console.log(l);let a=l.hierarchy.split("-//-");try{let s=a[0],r=a[1],d=a[2],j={};j.ws=s,j.pj=r,j.pg=d||null,j.heirID=l.hierarchy_ID,j.currentID=l.selectedID,window.sessionStorage.setItem("pagedata",JSON.stringify(j)),console.log(j),window.location.replace("/data-handler/frontpage")}catch(s){console.log(s)}}function k(l,a,s="Workspaces",r=["root"]){let d=document.getElementById(a),j=v.createRoot(d);console.log(l),d.addEventListener("click",()=>{N().type!=="Workspaces"?document.getElementById("open_btn").disabled=!1:document.getElementById("open_btn").disabled=!0}),j.render(e.jsx(_,{data:l,default:r,root:s}))}async function H(){const l=document.getElementById("popup"),a=()=>{l.classList.remove("open-popup")};l.classList.add("open-popup"),R.render(e.jsx(L,{close:a}))}
